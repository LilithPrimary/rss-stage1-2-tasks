(()=>{"use strict";var n={800:(n,t,e)=>{e.d(t,{Z:()=>o});var i=e(645),r=e.n(i)()((function(n){return n[1]}));r.push([n.id,"*,\n*:before,\n*:after {\n  padding: 0;\n  margin: 0;\n  border: 0;\n  box-sizing: border-box;\n  font-weight: inherit;\n  font-size: inherit;\n  user-select: none;\n}\n\na {\n  text-decoration: none;\n  font-family: inherit;\n  color: inherit;\n}\n\nul,\nol,\nli {\n  list-style: none;\n}\n\nimg {\n  vertical-align: top;\n}\n\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  font-weight: inherit;\n  font-size: inherit;\n}\n\nhtml,\nbody {\n  scroll-behavior: smooth;\n  min-height: 100vh;\n  font-size: 16px;\n  line-height: normal;\n  font-weight: 400;\n  font-style: normal;\n  overflow-x: hidden;\n}",""]);const o=r},575:(n,t,e)=>{e.d(t,{Z:()=>o});var i=e(645),r=e.n(i)()((function(n){return n[1]}));r.push([n.id,".win__wrapper {\n  padding: 20px;\n  max-width: 1440px;\n  width: 100%;\n  position: relative;\n}\n\n.winners__counter {\n  position: absolute;\n  left: 50%;\n  transform: translate(-50%);\n  top: -50px;\n  font-size: 25px;\n}\n\n.win__table {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n}\n\n.table__row {\n  display: grid;\n  grid-template-columns: 0.5fr 1fr 1fr 1fr 1fr;\n  width: 100%;\n}\n\n.table__cell {\n  text-align: center;\n  vertical-align: middle;\n  padding: 20px;\n  overflow: hidden;\n}\n\n.table__cell:not(.header__cell):nth-of-type(even) {\n  background-color: darkgray;\n}\n\n.table__cell:not(.header__cell):nth-of-type(2) {\n  font-size: 30px;\n}\n\n.header__cell {\n  background-color: var(--color-black);\n  color: white;\n  font-weight: 600;\n}\n\n.table__wins,\n.table__time {\n  cursor: pointer;\n  transition: .3s;\n  position: relative;\n}\n\n.table__wins:active,\n.table__time:active {\n  transform: scale(0.95);\n}\n\n.asc::before {\n  content: '↑';\n  color: white;\n  position: absolute;\n  font-weight: 700;\n  left: 20px;\n}\n\n.desc::before {\n  content: '↓';\n  color: white;\n  position: absolute;\n  font-weight: 700;\n  left: 20px;\n}\n\n.table__wrapper {\n  width: 100%;\n}",""]);const o=r},426:(n,t,e)=>{e.d(t,{Z:()=>d});var i=e(645),r=e.n(i),o=e(667),a=e.n(o),s=e(235),c=r()((function(n){return n[1]})),l=a()(s.Z);c.push([n.id,':root {\n  --color-black: rgb(62, 66, 65);\n  --color-blue: rgb(186, 221, 217);\n  --color-orange: rgb(254, 204, 0);\n  --color-yellow: rgba(252, 236, 15);\n  --color-grey: #e8e8e8;\n}\n\n.body {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-items: center;\n  background-color: var(--color-grey);\n  font-family: "Rubik";\n}\n\n.body::-webkit-scrollbar {\n  width: 0;\n}\n\n.main {\n  width: 100%;\n  min-height: calc(100vh - 345px);\n  padding: 30px;\n  padding-top: 110px;\n  display: flex;\n  justify-content: center;\n  position: relative;\n}\n\n.garage__wrapper {\n  width: 100%;\n  height: 100%;\n  max-width: 1440px;\n  display: flex;\n  flex-direction: column;\n  row-gap: 10px;\n}\n\n.header {\n  width: 100%;\n  height: 245px;\n  background-image: url('+l+');\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: 1440px;\n  display: flex;\n  justify-content: center;\n}\n\n.header__btns-wrapper {\n  padding-top: 20px;\n  display: flex;\n  align-items: flex-start;\n  column-gap: 20px;\n}\n\n.header__btn {\n  font-size: 20px;\n}\n\n.main__win-message {\n  color: var(--color-orange);\n  font-size: 50px;\n  font-weight: 700;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  display: none;\n}\n\n.main__ctrls {\n  width: 450px;\n  padding: 25px 20px;\n  display: flex;\n  flex-direction: column;\n  row-gap: 40px;\n  background: darkgray;\n  position: absolute;\n  left: 50%;\n  transform: translate(-50%);\n  top: -175px;\n}\n\n.ctrls__wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-top: solid 2px white;\n  padding-top: 20px;\n  position: relative;\n}\n\n.ctrls__wrapper::before {\n  content: "";\n  background-color: darkgray;\n  display: block;\n  padding: 0 10px;\n  position: absolute;\n  color: white;\n  top: -10px;\n  left: 50%;\n  transform: translate(-50%);\n}\n\n.ctrls__create::before {\n  content: "Create car";\n}\n\n.ctrls__edit::before {\n  content: "Edit car";\n}\n\n.ctrls__input {\n  outline: none;\n  padding: 0 10px;\n  height: 40px;\n  width: 70%;\n  border-radius: 10px;\n}\n\n.ctrls__input:focus {\n  border: 1px solid var(--color-orange);\n}\n\n.ctrls__color {\n  background-color: transparent;\n  height: 40px;\n  width: 40px;\n}\n\n.ctrl__btn {\n  background-color: transparent;\n  color: greenyellow;\n  font-size: 40px;\n}\n\n.ctrls__btns {\n  justify-content: space-around;\n  border: none;\n  padding: 0;\n}\n\n.ctrls__counter {\n  color: var(--color-yellow);\n  font-size: 20px;\n  text-align: center;\n}\n\n.car {\n  width: 100%;\n  border: var(--color-blue) solid 2px;\n  padding: 10px;\n  background: var(--color-black);\n  border-radius: 10px;\n}\n\n.car__btn-wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  column-gap: 5px;\n}\n\n.btn {\n  cursor: pointer;\n  background-color: transparent;\n  transition: .3s;\n}\n\n.btn:active {\n  transform: scale(0.95);\n}\n\n.car__btn {\n  color: white;\n  font-size: 50px;\n}\n\n.car__delete-btn {\n  font-size: 35px;\n}\n\n.car__top {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.car__name {\n  color: white;\n  font-size: 20px;\n}\n\n.car__track {\n  border-bottom: dashed 3px var(--color-yellow);\n  position: relative;\n}\n\n.car__img {\n  margin-bottom: -13px;\n  vertical-align: bottom;\n  position: relative;\n  left: 0;\n  font-size: 80px;\n  color: var(--color-blue);\n}\n\n.car__finish {\n  font-size: 50px;\n  position: absolute;\n  right: 100px;\n  bottom: 0;\n  color: var(--color-orange);\n}\n\n.car__img--drive {\n  left: calc(100% - 100px);\n}\n\n.pagination__wrapper {\n  padding-top: 20px;\n  display: flex;\n  column-gap: 10px;\n  margin: 0 auto;\n}\n\n.pagination__number {\n  text-align: center;\n  font-weight: 700;\n  font-size: 20px;\n  width: 30px;\n}\n\n.pagination__btn {\n  text-align: center;\n  font-size: 30px;\n}\n\n.btn--disabled {\n  pointer-events: none;\n  color: gray;\n}\n\n.btn--active {\n  transform: scale(1.2);\n}\n\n.footer {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n}\n\n.footer__wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 100px;\n  max-width: 1440px;\n  width: 100%;\n  background-color: var(--color-yellow);\n  padding: 20px;\n}\n\n.rslogo {\n  width: 30px;\n  height: 30px;\n}\n\n.link {\n  fill: var(--color-black);\n  text-decoration: none;\n  color: var(--color-black);\n  transition: 0.3s;\n}\n\n@media (min-width: 768px) {\n  .btn:hover {\n    color: var(--color-orange);\n  }\n\n  .link:hover {\n    fill: var(--color-orange);\n    color: var(--color-orange);\n  }\n\n}',""]);const d=c},645:n=>{n.exports=function(n){var t=[];return t.toString=function(){return this.map((function(t){var e=n(t);return t[2]?"@media ".concat(t[2]," {").concat(e,"}"):e})).join("")},t.i=function(n,e,i){"string"==typeof n&&(n=[[null,n,""]]);var r={};if(i)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(r[a]=!0)}for(var s=0;s<n.length;s++){var c=[].concat(n[s]);i&&r[c[0]]||(e&&(c[2]?c[2]="".concat(e," and ").concat(c[2]):c[2]=e),t.push(c))}},t}},667:n=>{n.exports=function(n,t){return t||(t={}),"string"!=typeof(n=n&&n.__esModule?n.default:n)?n:(/^['"].*['"]$/.test(n)&&(n=n.slice(1,-1)),t.hash&&(n+=t.hash),/["'() \t\n]/.test(n)||t.needQuotes?'"'.concat(n.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):n)}},235:(n,t,e)=>{e.d(t,{Z:()=>i});const i=e.p+"94cf2f7c1537c8ca65db03424031e349.jpg"},379:(n,t,e)=>{var i,r=function(){var n={};return function(t){if(void 0===n[t]){var e=document.querySelector(t);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(n){e=null}n[t]=e}return n[t]}}(),o=[];function a(n){for(var t=-1,e=0;e<o.length;e++)if(o[e].identifier===n){t=e;break}return t}function s(n,t){for(var e={},i=[],r=0;r<n.length;r++){var s=n[r],c=t.base?s[0]+t.base:s[0],l=e[c]||0,d="".concat(c," ").concat(l);e[c]=l+1;var u=a(d),h={css:s[1],media:s[2],sourceMap:s[3]};-1!==u?(o[u].references++,o[u].updater(h)):o.push({identifier:d,updater:v(h,t),references:1}),i.push(d)}return i}function c(n){var t=document.createElement("style"),i=n.attributes||{};if(void 0===i.nonce){var o=e.nc;o&&(i.nonce=o)}if(Object.keys(i).forEach((function(n){t.setAttribute(n,i[n])})),"function"==typeof n.insert)n.insert(t);else{var a=r(n.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var l,d=(l=[],function(n,t){return l[n]=t,l.filter(Boolean).join("\n")});function u(n,t,e,i){var r=e?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(n.styleSheet)n.styleSheet.cssText=d(t,r);else{var o=document.createTextNode(r),a=n.childNodes;a[t]&&n.removeChild(a[t]),a.length?n.insertBefore(o,a[t]):n.appendChild(o)}}function h(n,t,e){var i=e.css,r=e.media,o=e.sourceMap;if(r?n.setAttribute("media",r):n.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),n.styleSheet)n.styleSheet.cssText=i;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(i))}}var p=null,f=0;function v(n,t){var e,i,r;if(t.singleton){var o=f++;e=p||(p=c(t)),i=u.bind(null,e,o,!1),r=u.bind(null,e,o,!0)}else e=c(t),i=h.bind(null,e,t),r=function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(e)};return i(n),function(t){if(t){if(t.css===n.css&&t.media===n.media&&t.sourceMap===n.sourceMap)return;i(n=t)}else r()}}n.exports=function(n,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var e=s(n=n||[],t);return function(n){if(n=n||[],"[object Array]"===Object.prototype.toString.call(n)){for(var i=0;i<e.length;i++){var r=a(e[i]);o[r].references--}for(var c=s(n,t),l=0;l<e.length;l++){var d=a(e[l]);0===o[d].references&&(o[d].updater(),o.splice(d,1))}e=c}}}}},t={};function e(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={id:i,exports:{}};return n[i](o,o.exports,e),o.exports}e.n=n=>{var t=n&&n.__esModule?()=>n.default:()=>n;return e.d(t,{a:t}),t},e.d=(n,t)=>{for(var i in t)e.o(t,i)&&!e.o(n,i)&&Object.defineProperty(n,i,{enumerable:!0,get:t[i]})},e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),e.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t),(()=>{var n;e.g.importScripts&&(n=e.g.location+"");var t=e.g.document;if(!n&&t&&(t.currentScript&&(n=t.currentScript.src),!n)){var i=t.getElementsByTagName("script");i.length&&(n=i[i.length-1].src)}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=n})(),e.nc=void 0,(()=>{var n=e(379),t=e.n(n),i=e(800);t()(i.Z,{insert:"head",singleton:!1}),i.Z.locals;var r=e(426);function o(n,{id:t="",classes:e,text:i="empty",color:r="none"}){const o=document.createElement(n);return o.classList.add(...e),""!==t&&(o.id=t),"empty"!==i&&(o.textContent=i),"none"!==r&&(o.style.color=r),o}t()(r.Z,{insert:"head",singleton:!1}),r.Z.locals;const a=n=>{const t=document.querySelector(".cars__wrapper");t.innerHTML="",t.append(...n.map((n=>n.renderCar())))};const s=n=>{return t=void 0,e=void 0,r=function*(){var t;n.ctrl.editWrapper.style.display="flex",n.ctrl.nameEditInput.value=n.carName.textContent||"",n.ctrl.colorEditInput.value=`#${t=n.carImg.style.color,t.slice(4,t.length-1).split(", ").map(Number).map((n=>1===n.toString(16).length?`0${n.toString(16)}`:n.toString(16))).join("")}`,n.ctrl.editingCar=n},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r};const c=n=>n.stopBtn.classList.remove("btn--disabled");function l(n){return t=this,e=void 0,r=function*(){const t=n;(n=>{n.style.left="calc(100% - 100px)"})(n.carImg);const e=yield function(n,{options:t="",id:e=0}){return i=this,r=void 0,a=function*(){return yield fetch(`${n}engine?id=${e}&status=${t}`,{method:"PATCH"})},new((o=void 0)||(o=Promise))((function(n,t){function e(n){try{c(a.next(n))}catch(n){t(n)}}function s(n){try{c(a.throw(n))}catch(n){t(n)}}function c(t){var i;t.done?n(t.value):(i=t.value,i instanceof o?i:new o((function(n){n(i)}))).then(e,s)}c((a=a.apply(i,r||[])).next())}));var i,r,o,a}(q,{options:"drive",id:t.id});if(c(t),500===e.status)throw(n=>{const t=n,e=t.carImg.offsetLeft;t.carImg.style.left=`${e}px`,t.carImg.style.transform="rotate(150deg)"})(n),Error("broke");const i=t.carName.textContent;return{status:e.status,id:t.id,time:t.carTime,name:i}},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r}function d(n,{options:t="",id:e=0}){return i=this,r=void 0,a=function*(){return yield fetch(`${n}engine?id=${e}&status=${t}`,{method:"PATCH"})},new((o=void 0)||(o=Promise))((function(n,t){function e(n){try{c(a.next(n))}catch(n){t(n)}}function s(n){try{c(a.throw(n))}catch(n){t(n)}}function c(t){var i;t.done?n(t.value):(i=t.value,i instanceof o?i:new o((function(n){n(i)}))).then(e,s)}c((a=a.apply(i,r||[])).next())}));var i,r,o,a}function u(n){return t=this,e=void 0,r=function*(){const t=n;(n=>{n.startBtn.classList.add("btn--disabled"),n.deleteBtn.classList.add("btn--disabled")})(t);const e=yield d(q,{options:"started",id:t.id});var i;return((n,t)=>{const e=t;e.carTime=+(n/1e3).toFixed(2),e.carImg.style.transition=`left ${n}ms`})((i=yield e.json()).distance/i.velocity,n),t},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r}const h=n=>{return t=void 0,e=void 0,r=function*(){yield d(q,{options:"stopped",id:n.id}),(n=>{const t=n;t.style.transition="none",t.style.transform="none",t.style.left="0"})(n.carImg),(n=>{n.startBtn.classList.remove("btn--disabled"),n.deleteBtn.classList.remove("btn--disabled"),n.stopBtn.classList.add("btn--disabled")})(n)},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r};const p=n=>{return t=void 0,e=void 0,r=function*(){return yield h(n),yield u(n),c(n),yield l(n)},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r};const f=n=>{return t=void 0,e=void 0,r=function*(){const t=yield function(n,t){return e=this,i=void 0,o=function*(){return yield fetch(`${n}garage?_limit=7&_page=${t}`)},new((r=void 0)||(r=Promise))((function(n,t){function a(n){try{c(o.next(n))}catch(n){t(n)}}function s(n){try{c(o.throw(n))}catch(n){t(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,s)}c((o=o.apply(e,i||[])).next())}));var e,i,r,o}(q,n.pagination.currentPage),e=t.headers.get("X-Total-Count");n.carCounter.textContent=`Total amount: ${e}`,n.pagination.setLastPage(+e),n.pagination.setPage();const i=yield t.json();return n.cars=i.map((t=>new g(t,n))),n.cars},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r};function v(n,t="",e="",i=""){return r=this,o=void 0,s=function*(){return yield fetch(`${n}winners?_limit=${i}&_page=${t}&${e}`)},new((a=void 0)||(a=Promise))((function(n,t){function e(n){try{c(s.next(n))}catch(n){t(n)}}function i(n){try{c(s.throw(n))}catch(n){t(n)}}function c(t){var r;t.done?n(t.value):(r=t.value,r instanceof a?r:new a((function(n){n(r)}))).then(e,i)}c((s=s.apply(r,o||[])).next())}));var r,o,a,s}var b=function(n,t,e,i){return new(e||(e=Promise))((function(r,o){function a(n){try{c(i.next(n))}catch(n){o(n)}}function s(n){try{c(i.throw(n))}catch(n){o(n)}}function c(n){var t;n.done?r(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,s)}c((i=i.apply(n,t||[])).next())}))};const y=n=>b(void 0,void 0,void 0,(function*(){yield function(n,t){return e=this,i=void 0,o=function*(){return yield fetch(`${n}garage/${t}`,{method:"DELETE"})},new((r=void 0)||(r=Promise))((function(n,t){function a(n){try{c(o.next(n))}catch(n){t(n)}}function s(n){try{c(o.throw(n))}catch(n){t(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,s)}c((o=o.apply(e,i||[])).next())}));var e,i,r,o}(q,n.id);const t=yield v(q);(yield t.json()).forEach((t=>b(void 0,void 0,void 0,(function*(){t.id===n.id&&(yield function(n,t){return e=this,i=void 0,o=function*(){return yield fetch(`${n}winners/${t}`,{method:"DELETE"})},new((r=void 0)||(r=Promise))((function(n,t){function a(n){try{c(o.next(n))}catch(n){t(n)}}function s(n){try{c(o.throw(n))}catch(n){t(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,s)}c((o=o.apply(e,i||[])).next())}));var e,i,r,o}(q,n.id))})))),n.ctrl.observer.update(yield f(n.ctrl)),yield n.ctrl.winnerPage.renderWinnersTable()}));class g{constructor(n,t){this.car=n,this.ctrl=t,this.carTime=0,this.startBtn=o("button",{classes:["btn","car__btn","car__start-btn","material-symbols-outlined"],text:"play_circle"}),this.stopBtn=o("button",{classes:["btn","car__btn","car__stop-btn","material-symbols-outlined","btn--disabled"],text:"stop_circle"}),this.editBtn=o("button",{classes:["btn","car__btn","car__edit-btn","material-symbols-outlined"],text:"edit_note"}),this.deleteBtn=o("button",{classes:["btn","car__btn","car__delete-btn","material-symbols-outlined"],text:"delete_forever"}),this.carName=o("div",{classes:["car__name"],text:this.car.name}),this.carImg=o("div",{classes:["car__img","material-symbols-outlined"],text:"agriculture",color:this.car.color}),this.id=this.car.id,this.car=n,this.ctrl=t}renderCar(){const n=o("div",{id:this.car.id.toString(),classes:["main__car","car"]}),t=o("div",{classes:["car__top"]});return t.append(this.createBtns(),this.carName),n.append(t,this.createTrack()),n}createBtns(){const n=o("div",{classes:["car__btn-wrapper"]});return this.setEventListner(this.startBtn,p),this.setEventListner(this.stopBtn,h),this.setEventListner(this.deleteBtn,y),this.setEventListner(this.editBtn,s),n.append(this.startBtn,this.stopBtn,this.editBtn,this.deleteBtn),n}createTrack(){const n=o("div",{classes:["car__track"]}),t=o("div",{classes:["car__finish","material-symbols-outlined"],text:"sports_score"});return n.append(this.carImg,t),n}setEventListner(n,t){n.addEventListener("click",(()=>t(this)))}}function m(n,{body:t}){return e=this,i=void 0,o=function*(){return yield fetch(`${n}garage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})},new((r=void 0)||(r=Promise))((function(n,t){function a(n){try{c(o.next(n))}catch(n){t(n)}}function s(n){try{c(o.throw(n))}catch(n){t(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,s)}c((o=o.apply(e,i||[])).next())}));var e,i,r,o}const w=n=>{return t=void 0,e=void 0,r=function*(){yield m(q,{body:{name:n.nameInput.value,color:n.colorInput.value}}),n.nameInput.value="",n.observer.update(yield f(n))},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r},_=["БелАЗ","JCB","JOHN DEERE","NEW HOLLAND","Lamborghini","Caterpillar","Stihl","Komatsu","Husqvarna AB","Claas","Terex","Massey Ferguson","Kubota","Wielton S. A.","Deutz-Fahr","International Harvester","AGCO","Hanomag"],x=["Mark","Mach","Spark","Spire","Crono","Ares","Fahr","5455","8210","1690","T20","135","880","35X","CF704","DF404"];const P=n=>n[Math.floor(Math.random()*n.length)],C=n=>{return t=void 0,e=void 0,r=function*(){const t=new Array(100).fill(0).map((()=>({name:`${P(_)} ${P(x)}`,color:`#${new Array(3).fill(0).map((()=>{const n=Math.floor(256*Math.random()).toString(16);return 1===n.length?`0${n}`:n})).join("")}`})));yield((n,t)=>{return e=void 0,i=void 0,o=function*(){yield Promise.all(t.map((n=>m(q,{body:n})))),n.observer.update(yield f(n))},new((r=void 0)||(r=Promise))((function(n,t){function a(n){try{c(o.next(n))}catch(n){t(n)}}function s(n){try{c(o.throw(n))}catch(n){t(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,s)}c((o=o.apply(e,i||[])).next())}));var e,i,r,o})(n,t)},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r};const E=n=>{return t=void 0,e=void 0,r=function*(){n.cars.forEach((n=>h(n))),(n=>{n.btnStartRace.classList.remove("btn--disabled"),n.btnResetRace.classList.add("btn--disabled")})(n)},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r};const S=n=>{return t=void 0,e=void 0,r=function*(){yield function(n,{body:t,id:e=0}){return i=this,r=void 0,a=function*(){return yield fetch(`${n}garage/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})},new((o=void 0)||(o=Promise))((function(n,t){function e(n){try{c(a.next(n))}catch(n){t(n)}}function s(n){try{c(a.throw(n))}catch(n){t(n)}}function c(t){var i;t.done?n(t.value):(i=t.value,i instanceof o?i:new o((function(n){n(i)}))).then(e,s)}c((a=a.apply(i,r||[])).next())}));var i,r,o,a}(q,{body:{name:n.nameEditInput.value,color:n.colorEditInput.value},id:n.editingCar.id}),n.editWrapper.style.display="none",n.editingCar.carImg.style.color=n.colorEditInput.value,n.editingCar.carName.textContent=n.nameEditInput.value,yield n.winnerPage.renderWinnersTable()},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r};function k(n,t){return e=this,i=void 0,o=function*(){const e=yield function(n,t){return e=this,i=void 0,o=function*(){return yield fetch(`${n}winners/${t}`)},new((r=void 0)||(r=Promise))((function(n,t){function a(n){try{c(o.next(n))}catch(n){t(n)}}function s(n){try{c(o.throw(n))}catch(n){t(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,s)}c((o=o.apply(e,i||[])).next())}));var e,i,r,o}(n,t.id),i=yield e.json();return yield fetch(`${n}winners/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({wins:i.wins+1,time:t.time<i.time?t.time:i.time})})},new((r=void 0)||(r=Promise))((function(n,t){function a(n){try{c(o.next(n))}catch(n){t(n)}}function s(n){try{c(o.throw(n))}catch(n){t(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,s)}c((o=o.apply(e,i||[])).next())}));var e,i,r,o}const L=n=>{return t=void 0,e=void 0,r=function*(){const t=document.querySelector(".main__win-message");n instanceof Error?t.textContent="Nobody wins. Everybody broken =(":(t.textContent=`${n.name} WINS! Time: ${n.time} sec!`,yield function(n,t){return e=this,i=void 0,o=function*(){const e=yield fetch(`${n}winners`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return 500===e.status&&(yield k(n,t)),e},new((r=void 0)||(r=Promise))((function(n,t){function a(n){try{c(o.next(n))}catch(n){t(n)}}function s(n){try{c(o.throw(n))}catch(n){t(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,s)}c((o=o.apply(e,i||[])).next())}));var e,i,r,o}(q,{id:n.id,wins:1,time:n.time})),t.style.display="block",setTimeout((()=>{t.style.display="none"}),3e3)},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r};const B=n=>{n.btnCreate.classList.toggle("btn--disabled"),n.btnCreateRandomCars.classList.toggle("btn--disabled")},T=n=>{return t=void 0,e=void 0,r=function*(){(n=>{n.btnStartRace.classList.add("btn--disabled"),B(n)})(n),yield Promise.all(n.cars.map((n=>h(n))));const t=yield Promise.all(n.cars.map((n=>u(n))));try{const e=yield Promise.any(t.map((n=>l(n))));yield L(e),yield n.winnerPage.renderWinnersTable()}catch(n){const t=n;yield L(t)}(n=>{n.btnResetRace.classList.remove("btn--disabled"),B(n)})(n)},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r};var $=e(575);t()($.Z,{insert:"head",singleton:!1}),$.Z.locals;var I=function(n,t,e,i){return new(e||(e=Promise))((function(r,o){function a(n){try{c(i.next(n))}catch(n){o(n)}}function s(n){try{c(i.throw(n))}catch(n){o(n)}}function c(n){var t;n.done?r(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,s)}c((i=i.apply(n,t||[])).next())}))};const j=n=>I(void 0,void 0,void 0,(function*(){const t=yield function(n,t){return e=this,i=void 0,o=function*(){const e=yield fetch(`${n}garage/${t}`);return yield e.json()},new((r=void 0)||(r=Promise))((function(n,t){function a(n){try{c(o.next(n))}catch(n){t(n)}}function s(n){try{c(o.throw(n))}catch(n){t(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,s)}c((o=o.apply(e,i||[])).next())}));var e,i,r,o}(q,n);return t}));const N=(n,t=1)=>{return e=void 0,i=void 0,a=function*(){const e=yield v(q,t.toString(),n,10..toString()),i=(yield e.json()).map((n=>{return t=n,I(void 0,void 0,void 0,(function*(){const n=o("div",{classes:["table__row"]}),e=o("div",{classes:["table__cell"],text:t.id.toString()}),i=o("div",{classes:["table__cell","material-symbols-outlined"],text:"agriculture"}),r=yield j(t.id);i.style.color=r.color;const a=[r.name,t.wins,t.time].map((n=>o("div",{classes:["table__cell"],text:n.toString()})));return n.append(e,i,...a),n}));var t}));return{rows:Promise.all(i),count:e.headers.get("X-Total-Count")}},new((r=void 0)||(r=Promise))((function(n,t){function o(n){try{c(a.next(n))}catch(n){t(n)}}function s(n){try{c(a.throw(n))}catch(n){t(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(n){n(e)}))).then(o,s)}c((a=a.apply(e,i||[])).next())}));var e,i,r,a};var W=function(n,t,e,i){return new(e||(e=Promise))((function(r,o){function a(n){try{c(i.next(n))}catch(n){o(n)}}function s(n){try{c(i.throw(n))}catch(n){o(n)}}function c(n){var t;n.done?r(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,s)}c((i=i.apply(n,t||[])).next())}))};class R{constructor(n){this.callback=n,this.lastPage=1,this.currentPage=1,this.backBtn=o("button",{classes:["btn","pagination__btn","material-symbols-outlined","btn--disabled"],text:"navigate_before"}),this.forwardBtn=o("button",{classes:["btn","pagination__btn","material-symbols-outlined"],text:"navigate_next"}),this.pageNumber=o("div",{classes:["pagination__number"],text:"1"}),this.callback=n}renderPaginationBlock(){const n=o("div",{classes:["pagination__wrapper"]});return n.append(this.backBtn,this.pageNumber,this.forwardBtn),this.addListeners(),n}setCurrentPage(n){this.currentPage=n,this.pageNumber.textContent=n.toString()}setLastPage(n){this.lastPage=Math.ceil(n/7)}setPage(){(({btns:n,curPage:t,lastPage:e})=>{n.forEach((n=>n.classList.remove("btn--disabled"))),0===e&&n.forEach((n=>n.classList.add("btn--disabled")));const[i,r]=n;1===t&&i.classList.add("btn--disabled"),t===e&&r.classList.add("btn--disabled")})({btns:[this.backBtn,this.forwardBtn],curPage:this.currentPage,lastPage:this.lastPage}),this.pageNumber.textContent=this.currentPage.toString()}addListeners(){this.backBtn.addEventListener("click",(()=>W(this,void 0,void 0,(function*(){this.currentPage-=1,this.callback()})))),this.forwardBtn.addEventListener("click",(()=>W(this,void 0,void 0,(function*(){this.currentPage+=1,this.callback()}))))}}var M=function(n,t,e,i){return new(e||(e=Promise))((function(r,o){function a(n){try{c(i.next(n))}catch(n){o(n)}}function s(n){try{c(i.throw(n))}catch(n){o(n)}}function c(n){var t;n.done?r(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,s)}c((i=i.apply(n,t||[])).next())}))};const O=n=>M(void 0,void 0,void 0,(function*(){yield n.renderWinnersTable()}));class z{constructor(){this.winsSort=o("div",{classes:["table__cell","header__cell","table__wins"],text:"Wins",id:"wins"}),this.timeSort=o("div",{classes:["table__cell","header__cell","table__wins"],text:"Time",id:"time"}),this.idSort=o("div",{classes:["table__cell","header__cell","table__wins"],text:"id",id:"id"}),this.wrapper=o("div",{classes:["win__wrapper"]}),this.carsWrapper=o("div",{classes:["table__wrapper"]}),this.sortOptions={sort:"",order:""},this.counter=o("div",{classes:["winners__counter"]}),this.pagination=new R(O.bind(null,this))}createHeader(){const n=o("div",{classes:["table__hearder","table__row"]}),t=["Car","Name"].map((n=>o("div",{classes:["table__cell","header__cell"],text:n})));return n.append(this.idSort,...t,this.winsSort,this.timeSort),n}createWrapper(){const n=o("div",{classes:["win__table","table"]});return n.append(this.createHeader(),this.carsWrapper,this.pagination.renderPaginationBlock()),this.wrapper.append(this.counter,n),this.wrapper.style.display="none",this.wrapper}renderWinnersPage(){return M(this,void 0,void 0,(function*(){return this.addListeners(),yield this.renderWinnersTable(),this.createWrapper()}))}renderWinnersTable(){return M(this,void 0,void 0,(function*(){const n=`_sort=${this.sortOptions.sort}&_order=${this.sortOptions.order}`;const{rows:t,count:e}=yield N(n,this.pagination.currentPage),i=yield t;this.pagination.setLastPage(+e),this.counter.textContent=`Total amount: ${e}`,(n=>{var t;if(""===n.sort)return;const e=document.querySelector(".desc")||document.querySelector(".asc");null==e||e.classList.remove("asc","desc"),null===(t=document.getElementById(n.sort))||void 0===t||t.classList.add(n.order.toLowerCase())})(this.sortOptions),this.pagination.setPage(),this.carsWrapper.innerHTML="",this.carsWrapper.append(...i)}))}addListeners(){this.winsSort.addEventListener("click",(n=>this.changeSorting(n.target))),this.timeSort.addEventListener("click",(n=>this.changeSorting(n.target))),this.idSort.addEventListener("click",(n=>this.changeSorting(n.target)))}changeSorting(n){return M(this,void 0,void 0,(function*(){((n,t)=>{n.id===t.sort?t.order=(n=>"DESC"===n.order?"ASC":"DESC")(t):(t.sort=n.id,t.order="ASC")})(n,this.sortOptions),yield this.renderWinnersTable()}))}}const A=n=>{const t=n;t.type="text",t.placeholder="name"},H=n=>{n.type="color"},Z=n=>{return t=void 0,e=void 0,r=function*(){n.observer.update(yield f(n))},new((i=void 0)||(i=Promise))((function(n,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function s(n){try{c(r.throw(n))}catch(n){o(n)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(n){n(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}));var t,e,i,r};class D{constructor(n){this.observer=n,this.nameInput=o("input",{classes:["ctrls__input","ctrls__name-input"]}),this.colorInput=o("input",{classes:["ctrls__color","ctrls__color-check"]}),this.btnCreate=o("button",{classes:["btn","ctrl__btn","ctrl__create-car-btn","material-symbols-outlined"],text:"done"}),this.nameEditInput=o("input",{classes:["ctrls__input","ctrls__edit-input"]}),this.colorEditInput=o("input",{classes:["ctrls__color","ctrls__edit-color-check"]}),this.btnEdit=o("button",{classes:["btn","ctrl__btn","ctrl__edit-car-btn","material-symbols-outlined"],text:"done"}),this.editWrapper=o("div",{classes:["ctrls__wrapper","ctrls__edit"]}),this.btnStartRace=o("button",{classes:["btn","ctrl__btn","material-symbols-outlined"],text:"flag_circle"}),this.btnResetRace=o("button",{classes:["btn","ctrl__btn","btn--disabled","material-symbols-outlined"],text:"restart_alt"}),this.btnCreateRandomCars=o("button",{classes:["btn","ctrl__btn","material-symbols-outlined"],text:"add_circle"}),this.editingCar=new g({name:"test",color:"white",id:0},this),this.carCounter=o("div",{classes:["ctrls__counter"]}),this.cars=[],this.racePage=o("div",{classes:["garage__wrapper"]}),this.winnerPage=new z,this.pagination=new R(Z.bind(null,this)),this.setCars=n=>{this.cars=n},this.observer=n,this.observer.subscribe(this.setCars)}renderPanel(){const n=o("div",{classes:["main__ctrls","ctrls"]}),t=o("div",{classes:["ctrls__wrapper","ctrls__create"]});return this.setEventListener(this.btnCreate,w),t.append(this.nameInput,this.colorInput,this.btnCreate),this.editWrapper.append(this.nameEditInput,this.colorEditInput,this.btnEdit),A(this.nameInput),H(this.colorInput),A(this.nameEditInput),H(this.colorEditInput),this.setEventListener(this.btnEdit,S),this.editWrapper.style.display="none",n.append(t,this.editWrapper,this.createCtrlBtns(),this.carCounter),n}setEditValue(n){this.colorEditInput.value=n.carImg.style.color,this.nameEditInput.value=n.carName.textContent||""}createCtrlBtns(){const n=o("div",{classes:["ctrls__wrapper","ctrls__btns"]});return this.setEventListener(this.btnStartRace,T),this.setEventListener(this.btnResetRace,E),this.setEventListener(this.btnCreateRandomCars,C),n.append(this.btnStartRace,this.btnResetRace,this.btnCreateRandomCars),n}setEventListener(n,t){n.addEventListener("click",(()=>t(this)))}}class F{constructor(n,t){this.ctrl=n,this.winner=t,this.racePageBtn=o("button",{classes:["btn","header__btn","btn--active"],text:"race"}),this.winnersPageBtn=o("button",{classes:["btn","header__btn"],text:"winners"}),this.ctrl=n,this.winner=t}renderSwitchBtns(){const n=o("div",{classes:["header__btns-wrapper"]});return this.addListeners(),n.append(this.racePageBtn,this.winnersPageBtn),n}addListeners(){this.racePageBtn.addEventListener("click",(()=>{this.switchToRacePage()})),this.winnersPageBtn.addEventListener("click",(()=>{this.switchToWinnerPage()}))}switchToRacePage(){this.ctrl.racePage.style.display="flex",this.winner.wrapper.style.display="none",this.toggleBtnsStyle()}switchToWinnerPage(){this.ctrl.racePage.style.display="none",this.winner.wrapper.style.display="flex",this.toggleBtnsStyle()}toggleBtnsStyle(){this.racePageBtn.classList.toggle("btn--active"),this.winnersPageBtn.classList.toggle("btn--active")}}const q="http://127.0.0.1:3000/";!function(){return n=this,t=void 0,i=function*(){const n=(()=>{let n;const t=new Set;return{subscribe:n=>{t.add(n)},unsubscribe:n=>{t.delete(n)},update:e=>{n=e,t.forEach((t=>t(n)))},getValue:()=>n}})();n.subscribe(a);const t=new D(n),e=yield f(t),i=new z;t.winnerPage=i;const r=new F(t,i);yield function(n,t){var e,i,r,s,c;return i=this,r=void 0,c=function*(){document.body.innerHTML='<header class="header"></header>\n  <main class="main">\n  </main>\n  <footer class="footer">\n    <div class="footer__wrapper">\n      <div>© 2022</div>\n      <a target="_blank" href="https://github.com/lilithprimary" class="link">LilithPrimary</a>\n      <a target="_blank" href="https://rs.school/" class="link">\n        <svg class="rslogo">\n          <use xlink:href="assets/img/sprite.svg#rslogo"></use>\n        </svg>\n      </a>\n    </div>\n  </footer>',null===(e=document.body.firstElementChild)||void 0===e||e.append(n.renderSwitchBtns());const i=o("div",{classes:["main__win-message"],text:"winners"}),r=document.querySelector(".main"),s=o("div",{classes:["cars__wrapper"]});n.ctrl.racePage.append(n.ctrl.renderPanel(),s,i),n.ctrl.racePage.append(n.ctrl.pagination.renderPaginationBlock()),null==r||r.append(n.ctrl.racePage,yield n.winner.renderWinnersPage()),a(t)},new((s=void 0)||(s=Promise))((function(n,t){function e(n){try{a(c.next(n))}catch(n){t(n)}}function o(n){try{a(c.throw(n))}catch(n){t(n)}}function a(t){var i;t.done?n(t.value):(i=t.value,i instanceof s?i:new s((function(n){n(i)}))).then(e,o)}a((c=c.apply(i,r||[])).next())}))}(r,e)},new((e=void 0)||(e=Promise))((function(r,o){function a(n){try{c(i.next(n))}catch(n){o(n)}}function s(n){try{c(i.throw(n))}catch(n){o(n)}}function c(n){var t;n.done?r(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,s)}c((i=i.apply(n,t||[])).next())}));var n,t,e,i}()})()})();