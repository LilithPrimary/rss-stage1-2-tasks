(()=>{"use strict";var t,n,e,a,r={800:(t,n,e)=>{e.d(n,{Z:()=>s});var a=e(645),r=e.n(a)()((function(t){return t[1]}));r.push([t.id,"*,\n*:before,\n*:after {\n  padding: 0;\n  margin: 0;\n  border: 0;\n  box-sizing: border-box;\n  font-weight: inherit;\n  font-size: inherit;\n  user-select: none;\n}\n\na {\n  text-decoration: none;\n  font-family: inherit;\n  color: inherit;\n}\n\nul,\nol,\nli {\n  list-style: none;\n}\n\nimg {\n  vertical-align: top;\n}\n\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  font-weight: inherit;\n  font-size: inherit;\n}\n\nhtml,\nbody {\n  scroll-behavior: smooth;\n  min-height: 100vh;\n  font-size: 16px;\n  line-height: normal;\n  font-weight: 400;\n  font-style: normal;\n  overflow-x: hidden;\n}",""]);const s=r},342:(t,n,e)=>{e.d(n,{Z:()=>s});var a=e(645),r=e.n(a)()((function(t){return t[1]}));r.push([t.id,".win__wrapper {\n  padding: 20px;\n  max-width: 1440px;\n  width: 100%;\n  position: relative;\n}\n\n.winners__counter {\n  position: absolute;\n  left: 50%;\n  transform: translate(-50%);\n  top: -50px;\n  font-size: 25px;\n}\n\n.win__table {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n}\n\n.table__row {\n  display: grid;\n  grid-template-columns: 0.5fr 1fr 1fr 1fr 1fr;\n  width: 100%;\n}\n\n.table__cell {\n  text-align: center;\n  vertical-align: middle;\n  padding: 20px;\n  overflow: hidden;\n}\n\n.table__cell:not(.header__cell):nth-of-type(even) {\n  background-color: darkgray;\n}\n\n.table__cell:not(.header__cell):nth-of-type(2) {\n  font-size: 30px;\n}\n\n.header__cell {\n  background-color: var(--color-black);\n  color: white;\n  font-weight: 600;\n}\n\n.table__wins,\n.table__time {\n  cursor: pointer;\n  transition: .3s;\n  position: relative;\n}\n\n.table__wins:active,\n.table__time:active {\n  transform: scale(0.95);\n}\n\n.asc::before {\n  content: '↑';\n  color: white;\n  position: absolute;\n  font-weight: 700;\n  left: 20px;\n}\n\n.desc::before {\n  content: '↓';\n  color: white;\n  position: absolute;\n  font-weight: 700;\n  left: 20px;\n}\n\n.table__wrapper {\n  width: 100%;\n}",""]);const s=r},426:(t,n,e)=>{e.d(n,{Z:()=>d});var a=e(645),r=e.n(a),s=e(667),i=e.n(s),o=e(235),c=r()((function(t){return t[1]})),l=i()(o.Z);c.push([t.id,':root {\n  --color-black: rgb(62, 66, 65);\n  --color-blue: rgb(186, 221, 217);\n  --color-orange: rgb(254, 204, 0);\n  --color-yellow: rgba(252, 236, 15);\n  --color-grey: #e8e8e8;\n}\n\n.body {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-items: center;\n  background-color: var(--color-grey);\n  font-family: "Rubik";\n}\n\n.body::-webkit-scrollbar {\n  width: 0;\n}\n\n.main {\n  width: 100%;\n  min-height: calc(100vh - 345px);\n  padding: 30px;\n  padding-top: 110px;\n  display: flex;\n  justify-content: center;\n  position: relative;\n}\n\n.garage__wrapper {\n  width: 100%;\n  height: 100%;\n  max-width: 1440px;\n  display: flex;\n  flex-direction: column;\n  row-gap: 10px;\n}\n\n.header {\n  width: 100%;\n  height: 245px;\n  background-image: url('+l+');\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: 1440px;\n  display: flex;\n  justify-content: center;\n}\n\n.header__btns-wrapper {\n  padding-top: 20px;\n  display: flex;\n  align-items: flex-start;\n  column-gap: 20px;\n}\n\n.header__btn {\n  font-size: 20px;\n}\n\n.main__win-message {\n  color: var(--color-orange);\n  font-size: 50px;\n  font-weight: 700;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  display: none;\n}\n\n.main__ctrls {\n  width: 450px;\n  padding: 25px 20px;\n  display: flex;\n  flex-direction: column;\n  row-gap: 40px;\n  background: darkgray;\n  position: absolute;\n  left: 50%;\n  transform: translate(-50%);\n  top: -175px;\n}\n\n.ctrls__wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-top: solid 2px white;\n  padding-top: 20px;\n  position: relative;\n}\n\n.ctrls__wrapper::before {\n  content: "";\n  background-color: darkgray;\n  display: block;\n  padding: 0 10px;\n  position: absolute;\n  color: white;\n  top: -10px;\n  left: 50%;\n  transform: translate(-50%);\n}\n\n.ctrls__create::before {\n  content: "Create car";\n}\n\n.ctrls__edit::before {\n  content: "Edit car";\n}\n\n.ctrls__input {\n  outline: none;\n  padding: 0 10px;\n  height: 40px;\n  width: 70%;\n  border-radius: 10px;\n}\n\n.ctrls__input:focus {\n  border: 1px solid var(--color-orange);\n}\n\n.ctrls__color {\n  background-color: transparent;\n  height: 40px;\n  width: 40px;\n}\n\n.ctrl__btn {\n  background-color: transparent;\n  color: greenyellow;\n  font-size: 40px;\n}\n\n.ctrls__btns {\n  justify-content: space-around;\n  border: none;\n  padding: 0;\n}\n\n.ctrls__counter {\n  color: var(--color-yellow);\n  font-size: 20px;\n  text-align: center;\n}\n\n.car {\n  width: 100%;\n  border: var(--color-blue) solid 2px;\n  padding: 10px;\n  background: var(--color-black);\n  border-radius: 10px;\n}\n\n.car__btn-wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  column-gap: 5px;\n}\n\n.btn {\n  cursor: pointer;\n  background-color: transparent;\n  transition: .3s;\n}\n\n.btn:active {\n  transform: scale(0.95);\n}\n\n.car__btn {\n  color: white;\n  font-size: 50px;\n}\n\n.car__delete-btn {\n  font-size: 35px;\n}\n\n.car__top {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.car__name {\n  color: white;\n  font-size: 20px;\n}\n\n.car__track {\n  border-bottom: dashed 3px var(--color-yellow);\n  position: relative;\n  display: flex;\n}\n\n.car__img {\n  margin-bottom: -13px;\n  vertical-align: bottom;\n  position: relative;\n  font-size: 80px;\n  color: var(--color-blue);\n}\n\n.car__finish {\n  font-size: 50px;\n  position: absolute;\n  right: 100px;\n  bottom: 0;\n  color: var(--color-orange);\n}\n\n.car__img--drive {\n  left: calc(100% - 100px);\n}\n\n.pagination__wrapper {\n  padding-top: 20px;\n  display: flex;\n  column-gap: 10px;\n  margin: 0 auto;\n}\n\n.pagination__number {\n  text-align: center;\n  font-weight: 700;\n  font-size: 20px;\n  width: 30px;\n}\n\n.pagination__btn {\n  text-align: center;\n  font-size: 30px;\n}\n\n.btn--disabled {\n  pointer-events: none;\n  color: gray;\n}\n\n.btn--active {\n  transform: scale(1.2);\n}\n\n.footer {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n}\n\n.footer__wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 100px;\n  max-width: 1440px;\n  width: 100%;\n  background-color: var(--color-yellow);\n  padding: 20px;\n}\n\n\n\n.rslogo {\n  width: 30px;\n  height: 30px;\n}\n\n.link {\n  fill: var(--color-black);\n  text-decoration: none;\n  color: var(--color-black);\n  transition: 0.3s;\n}\n\n@media (min-width: 768px) {\n  .btn:hover {\n    color: var(--color-orange);\n  }\n\n  .link:hover {\n    fill: var(--color-orange);\n    color: var(--color-orange);\n  }\n\n}',""]);const d=c},645:t=>{t.exports=function(t){var n=[];return n.toString=function(){return this.map((function(n){var e=t(n);return n[2]?"@media ".concat(n[2]," {").concat(e,"}"):e})).join("")},n.i=function(t,e,a){"string"==typeof t&&(t=[[null,t,""]]);var r={};if(a)for(var s=0;s<this.length;s++){var i=this[s][0];null!=i&&(r[i]=!0)}for(var o=0;o<t.length;o++){var c=[].concat(t[o]);a&&r[c[0]]||(e&&(c[2]?c[2]="".concat(e," and ").concat(c[2]):c[2]=e),n.push(c))}},n}},667:t=>{t.exports=function(t,n){return n||(n={}),"string"!=typeof(t=t&&t.__esModule?t.default:t)?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),n.hash&&(t+=n.hash),/["'() \t\n]/.test(t)||n.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},235:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"94cf2f7c1537c8ca65db03424031e349.jpg"},265:(t,n,e)=>{var a=e(379),r=e.n(a),s=e(800);r()(s.Z,{insert:"head",singleton:!1}),s.Z.locals},654:(t,n,e)=>{var a=e(379),r=e.n(a),s=e(426);r()(s.Z,{insert:"head",singleton:!1}),s.Z.locals},379:(t,n,e)=>{var a,r=function(){var t={};return function(n){if(void 0===t[n]){var e=document.querySelector(n);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}t[n]=e}return t[n]}}(),s=[];function i(t){for(var n=-1,e=0;e<s.length;e++)if(s[e].identifier===t){n=e;break}return n}function o(t,n){for(var e={},a=[],r=0;r<t.length;r++){var o=t[r],c=n.base?o[0]+n.base:o[0],l=e[c]||0,d="".concat(c," ").concat(l);e[c]=l+1;var p=i(d),h={css:o[1],media:o[2],sourceMap:o[3]};-1!==p?(s[p].references++,s[p].updater(h)):s.push({identifier:d,updater:g(h,n),references:1}),a.push(d)}return a}function c(t){var n=document.createElement("style"),a=t.attributes||{};if(void 0===a.nonce){var s=e.nc;s&&(a.nonce=s)}if(Object.keys(a).forEach((function(t){n.setAttribute(t,a[t])})),"function"==typeof t.insert)t.insert(n);else{var i=r(t.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}return n}var l,d=(l=[],function(t,n){return l[t]=n,l.filter(Boolean).join("\n")});function p(t,n,e,a){var r=e?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(t.styleSheet)t.styleSheet.cssText=d(n,r);else{var s=document.createTextNode(r),i=t.childNodes;i[n]&&t.removeChild(i[n]),i.length?t.insertBefore(s,i[n]):t.appendChild(s)}}function h(t,n,e){var a=e.css,r=e.media,s=e.sourceMap;if(r?t.setAttribute("media",r):t.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleSheet)t.styleSheet.cssText=a;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(a))}}var u=null,b=0;function g(t,n){var e,a,r;if(n.singleton){var s=b++;e=u||(u=c(n)),a=p.bind(null,e,s,!1),r=p.bind(null,e,s,!0)}else e=c(n),a=h.bind(null,e,n),r=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)};return a(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;a(t=n)}else r()}}t.exports=function(t,n){(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var e=o(t=t||[],n);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var a=0;a<e.length;a++){var r=i(e[a]);s[r].references--}for(var c=o(t,n),l=0;l<e.length;l++){var d=i(e[l]);0===s[d].references&&(s[d].updater(),s.splice(d,1))}e=c}}}},986:(t,n,e)=>{function a(t,{id:n="",classes:e,text:a="empty",color:r="none"}){const s=document.createElement(t);return s.classList.add(...e),""!==n&&(s.id=n),"empty"!==a&&(s.textContent=a),"none"!==r&&(s.style.color=r),s}e.d(n,{l:()=>D});const r=t=>{const n=document.querySelector(".cars__wrapper");n.innerHTML="",n.append(...t.map((t=>t.renderCar())))},s=async t=>{var n;t.ctrl.btns.editWrapper.style.display="flex",t.ctrl.btns.nameEditInput.value=t.carName.textContent||"",t.ctrl.btns.colorEditInput.value=`#${n=t.carImg.style.color,n.slice(4,n.length-1).split(", ").map(Number).map((t=>1===t.toString(16).length?`0${t.toString(16)}`:t.toString(16))).join("")}`,t.ctrl.editingCar=t},i="https://asyn-race-rs.onrender.com/",o=t=>t.stopBtn.classList.remove("btn--disabled");async function c(t){const n=t;(t=>{t.style.left="calc(100% - 100px)"})(t.carImg);const e=await async function(t,{options:n="",id:e=0}){return await fetch(`${t}engine?id=${e}&status=${n}`,{method:"PATCH"})}(i,{options:"drive",id:n.id});if(o(n),500===e.status)throw(t=>{const n=t,e=n.carImg.offsetLeft;n.carImg.style.left=`${e}px`,n.carImg.style.transform="rotate(150deg)"})(t),Error("broke");const a=n.carName.textContent;return{status:e.status,id:n.id,time:n.carTime,name:a}}async function l(t,{options:n="",id:e=0}){const a=await fetch(`${t}engine?id=${e}&status=${n}`,{method:"PATCH"});return await a.json()}async function d(t){const n=t;(t=>{t.startBtn.classList.add("btn--disabled"),t.deleteBtn.classList.add("btn--disabled")})(n);var e;return((t,n)=>{const e=n;e.carTime=+(t/1e3).toFixed(2),e.carImg.style.transition=`left ${t/1.5}ms`})((e=await l(i,{options:"started",id:n.id})).distance/e.velocity,t),n}const p=async t=>(await d(t),o(t),await c(t));async function h(t,n){const e=await fetch(`${t}garage?_limit=7&_page=${n}`),a=e.headers.get("X-Total-Count");return{cars:await e.json(),count:a}}const u=(t,n)=>(n.pagination.setPage(),n.cars=t.map((t=>new f(t,n))),n.cars),b=async t=>{const{cars:n,count:e}=await h(i,t.pagination.currentPage);if(t.btns.carCounter.textContent=`Total amount: ${e}`,t.pagination.setLastPage(+e)){const n=await h(i,t.pagination.currentPage);return u(n.cars,t)}return u(n,t)};async function g(t,n="",e="",a=""){return await fetch(`${t}winners?_limit=${a}&_page=${n}&${e}`)}const m=async t=>{await async function(t,n){return await fetch(`https://asyn-race-rs.onrender.com/garage/${n}`,{method:"DELETE"})}(0,t.id);const n=await g(i);(await n.json()).some((n=>n.id===t.id))&&await async function(t,n){return await fetch(`https://asyn-race-rs.onrender.com/winners/${n}`,{method:"DELETE"})}(0,t.id),t.ctrl.observer.update(await b(t.ctrl)),await t.ctrl.winnerPage.renderWinnersTable()},_=async t=>{await l(i,{options:"stopped",id:t.id}),(t=>{const n=t;n.style.transition="none",n.style.transform="none",n.style.left="0"})(t.carImg),(t=>{t.startBtn.classList.remove("btn--disabled"),t.deleteBtn.classList.remove("btn--disabled"),t.stopBtn.classList.add("btn--disabled")})(t)};class f{constructor(t,n){this.car=t,this.ctrl=n,this.carTime=0,this.startBtn=a("button",{classes:["btn","car__btn","car__start-btn","material-symbols-outlined"],text:"play_circle"}),this.stopBtn=a("button",{classes:["btn","car__btn","car__stop-btn","material-symbols-outlined","btn--disabled"],text:"stop_circle"}),this.editBtn=a("button",{classes:["btn","car__btn","car__edit-btn","material-symbols-outlined"],text:"edit_note"}),this.deleteBtn=a("button",{classes:["btn","car__btn","car__delete-btn","material-symbols-outlined"],text:"delete_forever"}),this.carName=a("div",{classes:["car__name"],text:this.car.name}),this.carImg=a("div",{classes:["car__img","material-symbols-outlined"],text:"agriculture",color:this.car.color}),this.id=this.car.id,this.car=t,this.ctrl=n}renderCar(){const t=a("div",{id:this.car.id.toString(),classes:["main__car","car"]}),n=a("div",{classes:["car__top"]});return n.append(this.createBtns(),this.carName),t.append(n,this.createTrack()),t}createBtns(){const t=a("div",{classes:["car__btn-wrapper"]});return this.setListner(this.startBtn,p),this.setListner(this.stopBtn,_),this.setListner(this.deleteBtn,m),this.setListner(this.editBtn,s),t.append(this.startBtn,this.stopBtn,this.editBtn,this.deleteBtn),t}createTrack(){const t=a("div",{classes:["car__track"]}),n=a("div",{classes:["car__finish","material-symbols-outlined"],text:"sports_score"});return t.append(this.carImg,n),t}setListner(t,n){t.addEventListener("click",(()=>n(this)))}}async function w(t,{body:n}){return await fetch(`${t}garage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}const y=async t=>{await w(i,{body:{name:t.btns.nameInput.value,color:t.btns.colorInput.value}}),t.btns.nameInput.value="",t.observer.update(await b(t))},v=["БелАЗ","JCB","JOHN DEERE","NEW HOLLAND","Lamborghini","Caterpillar","Stihl","Komatsu","Husqvarna AB","Claas","Terex","Massey Ferguson","Kubota","Wielton S. A.","Deutz-Fahr","International Harvester","AGCO","Hanomag"],x=["Mark","Mach","Spark","Spire","Crono","Ares","Fahr","5455","8210","1690","T20","135","880","35X","CF704","DF404"],P=t=>t[Math.floor(Math.random()*t.length)],S=async t=>{const n=new Array(100).fill(0).map((()=>({name:`${P(v)} ${P(x)}`,color:`#${new Array(3).fill(0).map((()=>{const t=Math.floor(256*Math.random()).toString(16);return 1===t.length?`0${t}`:t})).join("")}`})));await(async(t,n)=>{await Promise.all(n.map((t=>w(i,{body:t})))),b(t).then(t.observer.update).catch((()=>{throw new Error}))})(t,n)},k=async t=>{t.cars.forEach((t=>_(t))),(t=>{t.btns.btnStartRace.classList.remove("btn--disabled"),t.btns.btnResetRace.classList.add("btn--disabled")})(t)},C=async t=>{var n;await async function(t,{body:n,id:e=0}){return await fetch(`${t}garage/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}(i,{body:{name:t.btns.nameEditInput.value,color:t.btns.colorEditInput.value},id:t.editingCar.id}),(n=t.editingCar).ctrl.btns.editWrapper.style.display="none",n.carImg.style.color=n.ctrl.btns.colorEditInput.value,n.carName.textContent=n.ctrl.btns.nameEditInput.value,await t.winnerPage.renderWinnersTable()};const L=t=>{const n=document.querySelector(".main__win-message");n.textContent=t,n.style.display="block",setTimeout((()=>{n.style.display="none"}),3e3)},E=async t=>{t instanceof Error?L("Nobody wins. Everybody broken =("):(L(`${t.name} WINS! Time: ${t.time} sec!`),await async function(t,n){const e=await fetch(`${t}winners`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return 500===e.status&&await async function(t,n){const e=await async function(t,n){return await fetch(`${t}winners/${n}`)}(t,n.id),a=await e.json();return await fetch(`${t}winners/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({wins:a.wins+1,time:n.time<a.time?n.time:a.time})})}(t,n),e}(i,{id:t.id,wins:1,time:t.time}))},B=t=>{t.btns.btnCreate.classList.toggle("btn--disabled"),t.btns.btnCreateRandomCars.classList.toggle("btn--disabled")},T=async t=>{if(!t.cars.length)return void L("Anybody here?");(t=>{t.btns.btnStartRace.classList.add("btn--disabled"),B(t)})(t),await Promise.all(t.cars.map(_));const n=await Promise.all(t.cars.map(d));try{const e=await Promise.any(n.map(c));await E(e),await t.winnerPage.renderWinnersTable()}catch(t){const n=t;await E(n)}(t=>{t.btns.btnResetRace.classList.remove("btn--disabled"),B(t)})(t)};var I=e(379),$=e.n(I),j=e(342);$()(j.Z,{insert:"head",singleton:!1}),j.Z.locals;const N=async(t,n=1)=>{const e=await g(i,n.toString(),t,10..toString()),r=(await e.json()).map((t=>(async t=>{const n=a("div",{classes:["table__row"]}),e=a("div",{classes:["table__cell"],text:t.id.toString()}),r=a("div",{classes:["table__cell","material-symbols-outlined"],text:"agriculture"}),s=await(async t=>{const n=await async function(t,n){const e=await fetch(`https://asyn-race-rs.onrender.com/garage/${n}`);return await e.json()}(0,t);return n})(t.id);r.style.color=s.color;const i=[s.name,t.wins,t.time].map((t=>a("div",{classes:["table__cell"],text:t.toString()})));return n.append(e,r,...i),n})(t)));return{rows:Promise.all(r),count:e.headers.get("X-Total-Count")}};class W{constructor(t,n){this.callback=t,this.itemPerPage=n,this.lastPage=1,this.currentPage=1,this.backBtn=a("button",{classes:["btn","pagination__btn","material-symbols-outlined","btn--disabled"],text:"navigate_before"}),this.forwardBtn=a("button",{classes:["btn","pagination__btn","material-symbols-outlined"],text:"navigate_next"}),this.pageNumber=a("div",{classes:["pagination__number"],text:"1"}),this.callback=t,this.itemPerPage=n}renderPaginationBlock(){const t=a("div",{classes:["pagination__wrapper"]});return t.append(this.backBtn,this.pageNumber,this.forwardBtn),this.addListeners(),t}setCurrentPage(t){this.currentPage=t,this.pageNumber.textContent=t.toString()}setLastPage(t){return this.lastPage=Math.ceil(t/this.itemPerPage),this.lastPage<this.currentPage&&1!==this.currentPage&&(this.currentPage=this.lastPage,!0)}setPage(){(({btns:t,curPage:n,lastPage:e})=>{t.forEach((t=>t.classList.remove("btn--disabled"))),0===e&&t.forEach((t=>t.classList.add("btn--disabled")));const[a,r]=t;1===n&&a.classList.add("btn--disabled"),n>=e&&r.classList.add("btn--disabled")})({btns:[this.backBtn,this.forwardBtn],curPage:this.currentPage,lastPage:this.lastPage}),this.pageNumber.textContent=this.currentPage.toString()}addListeners(){this.backBtn.addEventListener("click",(async()=>{this.currentPage-=1,this.callback()})),this.forwardBtn.addEventListener("click",(async()=>{this.currentPage+=1,this.callback()}))}}const R=async t=>{await t.renderWinnersTable()};class M{constructor(){this.winsSort=a("div",{classes:["table__cell","header__cell","table__wins"],text:"Wins",id:"wins"}),this.timeSort=a("div",{classes:["table__cell","header__cell","table__wins"],text:"Time",id:"time"}),this.idSort=a("div",{classes:["table__cell","header__cell","table__wins"],text:"id",id:"id"}),this.wrapper=a("div",{classes:["win__wrapper"]}),this.carsWrapper=a("div",{classes:["table__wrapper"]}),this.sortOptions={sort:"",order:""},this.counter=a("div",{classes:["winners__counter"]}),this.pagination=new W(R.bind(null,this),10)}createHeader(){const t=a("div",{classes:["table__hearder","table__row"]}),n=["Car","Name"].map((t=>a("div",{classes:["table__cell","header__cell"],text:t})));return t.append(this.idSort,...n,this.winsSort,this.timeSort),t}createWrapper(){const t=a("div",{classes:["win__table","table"]});return t.append(this.createHeader(),this.carsWrapper,this.pagination.renderPaginationBlock()),this.wrapper.append(this.counter,t),this.wrapper.style.display="none",this.wrapper}async renderWinnersPage(){return this.addListeners(),await this.renderWinnersTable(),this.createWrapper()}async renderWinnersTable(){const t=`_sort=${this.sortOptions.sort}&_order=${this.sortOptions.order}`;const{rows:n,count:e}=await N(t,this.pagination.currentPage),a=await n;this.pagination.setLastPage(+e)?await this.renderWinnersTable():(this.counter.textContent=`Total amount: ${e}`,(t=>{var n;if(""===t.sort)return;const e=document.querySelector(".desc")||document.querySelector(".asc");null==e||e.classList.remove("asc","desc"),null===(n=document.getElementById(t.sort))||void 0===n||n.classList.add(t.order.toLowerCase())})(this.sortOptions),this.pagination.setPage(),this.carsWrapper.innerHTML="",this.carsWrapper.append(...a))}addListeners(){this.winsSort.addEventListener("click",(t=>this.changeSorting(t.target))),this.timeSort.addEventListener("click",(t=>this.changeSorting(t.target))),this.idSort.addEventListener("click",(t=>this.changeSorting(t.target)))}async changeSorting(t){((t,n)=>{t.id===n.sort?n.order=(t=>"DESC"===t.order?"ASC":"DESC")(n):(n.sort=t.id,n.order="ASC")})(t,this.sortOptions),await this.renderWinnersTable()}}const O=t=>{const n=t;n.type="text",n.placeholder="name"},z=t=>{t.type="color"};class A{constructor(t){this.ctrls=t,this.nameInput=a("input",{classes:["ctrls__input","ctrls__name-input"]}),this.colorInput=a("input",{classes:["ctrls__color","ctrls__color-check"]}),this.btnCreate=a("button",{classes:["btn","ctrl__btn","ctrl__create-car-btn","material-symbols-outlined"],text:"done"}),this.nameEditInput=a("input",{classes:["ctrls__input","ctrls__edit-input"]}),this.colorEditInput=a("input",{classes:["ctrls__color","ctrls__edit-color-check"]}),this.btnEdit=a("button",{classes:["btn","ctrl__btn","ctrl__edit-car-btn","material-symbols-outlined"],text:"done"}),this.editWrapper=a("div",{classes:["ctrls__wrapper","ctrls__edit"]}),this.btnStartRace=a("button",{classes:["btn","ctrl__btn","material-symbols-outlined"],text:"flag_circle"}),this.btnResetRace=a("button",{classes:["btn","ctrl__btn","btn--disabled","material-symbols-outlined"],text:"restart_alt"}),this.btnCreateRandomCars=a("button",{classes:["btn","ctrl__btn","material-symbols-outlined"],text:"add_circle"}),this.racePage=a("div",{classes:["garage__wrapper"]}),this.carCounter=a("div",{classes:["ctrls__counter"]}),this.ctrls=t}renderPanel(){const t=a("div",{classes:["main__ctrls","ctrls"]}),n=a("div",{classes:["ctrls__wrapper","ctrls__create"]});return n.append(this.nameInput,this.colorInput,this.btnCreate),this.editWrapper.append(this.nameEditInput,this.colorEditInput,this.btnEdit),O(this.nameInput),z(this.colorInput),O(this.nameEditInput),z(this.colorEditInput),this.editWrapper.style.display="none",t.append(n,this.editWrapper,this.createCtrlBtns(),this.carCounter),t}createCtrlBtns(){const t=a("div",{classes:["ctrls__wrapper","ctrls__btns"]});return t.append(this.btnStartRace,this.btnResetRace,this.btnCreateRandomCars),t}setListener(t,n){t.addEventListener("click",(()=>n(this.ctrls)))}setEditValue(t){this.colorEditInput.value=t.carImg.style.color,this.nameEditInput.value=t.carName.textContent||""}}const H=async t=>{b(t).then(t.observer.update).catch((t=>{throw Error(t)}))};class Z{constructor(t){this.observer=t,this.editingCar=new f({name:"test",color:"white",id:0},this),this.cars=[],this.winnerPage=new M,this.pagination=new W(H.bind(null,this),7),this.btns=new A(this),this.setCars=t=>{this.cars=t},this.observer=t,this.observer.subscribe(this.setCars),this.setListeners()}setListeners(){this.btns.setListener(this.btns.btnCreate,y),this.btns.setListener(this.btns.btnEdit,C),this.btns.setListener(this.btns.btnStartRace,T),this.btns.setListener(this.btns.btnResetRace,k),this.btns.setListener(this.btns.btnCreateRandomCars,S)}}class q{constructor(t,n){this.ctrl=t,this.winner=n,this.racePageBtn=a("button",{classes:["btn","header__btn","btn--active"],text:"race"}),this.winnersPageBtn=a("button",{classes:["btn","header__btn"],text:"winners"}),this.ctrl=t,this.winner=n}renderSwitchBtns(){const t=a("div",{classes:["header__btns-wrapper"]});return this.addListeners(),t.append(this.racePageBtn,this.winnersPageBtn),t}addListeners(){this.racePageBtn.addEventListener("click",(()=>{this.switchToRacePage()})),this.winnersPageBtn.addEventListener("click",(()=>{this.switchToWinnerPage()}))}switchToRacePage(){this.ctrl.btns.racePage.style.display="flex",this.winner.wrapper.style.display="none",this.toggleBtnsStyle()}switchToWinnerPage(){this.ctrl.btns.racePage.style.display="none",this.winner.wrapper.style.display="flex",this.toggleBtnsStyle()}toggleBtnsStyle(){this.racePageBtn.classList.toggle("btn--active"),this.winnersPageBtn.classList.toggle("btn--active")}}async function D(){const t=(()=>{let t;const n=new Set;return{subscribe:t=>{n.add(t)},unsubscribe:t=>{n.delete(t)},update:e=>{t=e,n.forEach((n=>n(t)))},getValue:()=>t}})();t.subscribe(r);const n=new Z(t),e=await b(n),s=new M;n.winnerPage=s;const i=new q(n,s);await async function(t,n){var e;document.body.innerHTML='<header class="header"></header>\n  <main class="main">\n  </main>\n  <footer class="footer">\n    <div class="footer__wrapper">\n      <div>© 2022</div>\n      <a target="_blank" href="https://github.com/lilithprimary" class="link">LilithPrimary</a>\n      <a target="_blank" href="https://rs.school/" class="link">\n        <svg class="rslogo">\n          <use xlink:href="assets/img/sprite.svg#rslogo"></use>\n        </svg>\n      </a>\n    </div>\n  </footer>',null===(e=document.body.firstElementChild)||void 0===e||e.append(t.renderSwitchBtns());const s=a("div",{classes:["main__win-message"],text:"winners"}),i=document.querySelector(".main"),o=a("div",{classes:["cars__wrapper"]});n[0].ctrl.btns.racePage.append(n[0].ctrl.btns.renderPanel(),o),n[0].ctrl.btns.racePage.append(s,n[0].ctrl.pagination.renderPaginationBlock()),null==i||i.append(n[0].ctrl.btns.racePage,await t.winner.renderWinnersPage()),r(n)}(i,e)}},575:(t,n,e)=>{e.a(t,(async(t,n)=>{try{e(265),e(654);var a=e(986);await(0,a.l)(),n()}catch(t){n(t)}}),1)}},s={};function i(t){var n=s[t];if(void 0!==n)return n.exports;var e=s[t]={id:t,exports:{}};return r[t](e,e.exports,i),e.exports}t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",n="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",e="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",a=t=>{t&&!t.d&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},i.a=(r,s,i)=>{var o;i&&((o=[]).d=1),o&&(o.moduleId=r.id);var c,l,d,p=new Set,h=r.exports,u=new Promise(((t,n)=>{d=n,l=t}));u[n]=h,u[t]=t=>(o&&t(o),p.forEach(t),u.catch((t=>{}))),u.moduleId=r.id,r.exports=u,s((r=>{var s;c=(r=>r.map((r=>{if(null!==r&&"object"==typeof r){if(r[t])return r;if(r.then){var s=[];s.d=0,r.then((t=>{i[n]=t,a(s)}),(t=>{i[e]=t,a(s)}));var i={};return i[t]=t=>t(s),i}}var o={};return o[t]=t=>{},o[n]=r,o})))(r);var i=()=>c.map((t=>{if(t[e])throw t[e];return t[n]})),l=new Promise((n=>{(s=()=>n(i)).r=0;var e=t=>t!==o&&!p.has(t)&&(p.add(t),t&&!t.d&&(s.r++,t.push(s)));c.map((n=>n[t](e)))}));return s.r?l:i()}),(t=>(t?d(u[e]=t):l(h),a(o)))),o&&(o.d=0)},i.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return i.d(n,{a:n}),n},i.d=(t,n)=>{for(var e in n)i.o(n,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var n=i.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var e=n.getElementsByTagName("script");e.length&&(t=e[e.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),i.nc=void 0,i(575)})();